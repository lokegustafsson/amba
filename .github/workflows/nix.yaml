name: self-hosted-nix-ci

on: push

jobs:
  build-s2e:
    name: Build S2E
    runs-on: [self-hosted, nixos, X64]

    steps:
      - uses: actions/checkout@v3

      - name: Build Nix flake checks
        run: |
          nix build -L --accept-flake-config .#s2e

  build-amba-lib:
    name: Build LIBAMBA
    runs-on: [self-hosted, nixos, X64]

    steps:
      - uses: actions/checkout@v3

      - name: Build Nix flake checks
        run: |
          nix build -L --accept-flake-config .#libamba

  build-amba:
    name: Build AMBA
    runs-on: [self-hosted, nixos, X64]

    steps:
      - uses: actions/checkout@v3

      - name: Build Nix flake checks
        run: |
          nix build -L --accept-flake-config .#amba

  build-devshell:
    name: Build AMBA devshell
    runs-on: [self-hosted, nixos, X64]

    steps:
      - uses: actions/checkout@v3

      - name: Build Nix flake checks
        run: |
          nix build -L --accept-flake-config .#devShells.x86_64-linux.default
