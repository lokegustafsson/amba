En stor mängd organisationer har utsats för utpressningsprogram (jfr eng.
\emph{ransomware}) minst en gång de senaste 24 månaderna~\cite{cyberreason2021,
    cyberreason2022}. Till exempel påverkades Irlands offentliga sjuknussystem
kraftigt när utpressningsprogram tog över en stor del av deras digitala
infrastruktur~\cite{hse_report, gallagher2023}.
Några av de direkta följderna av att en lyckad attack är: höga kostnader för
organisationen; stoppad produktion; konsekvenser från reglerare;
och skadat anseende~\cite{cyberreason2021, cyberreason2022}. Dessutom leder
de höga kostnaderna till bland annat uppsägningar av anställda för att kunna
kompensera~\cite{cyberreason2021, cyberreason2022}. I
många fall är människan den svaga länken i cyberattacker men angripare och
skadeprogram (jfr eng. \emph{malware}) utnyttjar också olika sårbarheter i
programvaror. WannaCry var ett utpressningsprogram som utnyttjade bl.a. en
sårbarhet som tillät fjärrexekvering av kod (jfr eng. \emph{remote code
    execution}) med ett specialutformat paket i SMB protokollet, en protokoll
för nätverksfildelning~\cite{enwiki:1152151996}.

% I en perfekt värld hade det varit fördelaktigt att undvika alla sårbarheter men
% det är inte möjligt. För att undvika, exempelvis, 100\% av minnessårbarheter
% krävs användning av minnessäkra programspråk (jfr eng. \emph{memory-safe
% language}). Minnessäkra programspråk tilltar en kombination av körtids- (jfr
% eng. \emph{runtime}) och kompileringstidskontroller (jfr eng. \emph{compile
% time checks}) för att undvika minnessårbarheter. Däremot finns det än idag
% många skäl för att fortsätta använda minnesosäkra programspråk som C, såsom
% prestandaskäl men främst äldre kod som är svåra att skriva
% om~\cite{computer_security_cs161}. Vidare kan utvecklare aldrig undvika alla
% misstag.

Genom att analysera program kan säkerhetsforskare och utvecklare upptäcka
och åtgärda sårbarheter innan en angripare. Programanalys går ut på att
analysera programegenskaper för kontrollera korrekthet och hitta möjliga
sårbarheter och kan utföras olika på nivåer: på källkoden eller på binären. I
den beskrivna situation ovan, skadeprogramsanalys (jfr eng. \emph{malware
    analysis}) och \emph{reverse engeneering}, är programmet som ska analyseras
oftast endast tillgänglig som binär~\cite{andriesse2018}.

Binäranalys är ofta en komplicerad och en tidskrävande och skadeprogram
ofta tilltar flera kända metoder för att försvåra analys och vilseleda
analysverktyg. Det krävs ofta en utforskande metod för att analysera och förstå
ett skadeprogram och testa ett antal metoder för att förstå och känneteckna
sårbarheter som skadeprogrammet utnyttjar. Detta kräver ett interaktivt och
utforskande analysverktyg som tillåter användaren att känneteckna problematik i
en analys och styra analysen åt ett håll som medför resultat.

Symbolisk exekvering, beskrivet i detalj i avsnitt~\ref{sec:symbolic_execution}
är en kraftfull teknik som har möjliggjort stora mängder
binäranalysmetoder\cite{survey_symb_exc, symnav}. Inom skadeprogramsanalys
tillåter det att ``upptäcka sårbarheter, kringgå autentisering eller
skyddssystem, eller förstå deras inre delar''~\cite{symnav}. Det är en ett sätt
att exekvera ett program abstrakt där en exekvering betraktar alla möjliga
indata som delar en viss exekveringsstig (jfr eng. \emph{execution path}) genom
programflödet. Detta möjliggörs genom att betrakta indatan som symbolisk där en
viss stig ackumulerar en stigvillkor (jfr eng. \emph{path condition}) på
symbolen vars lösning/lösningar beskriver alla värden på symbolen som leder
till att programmet följer motsvarande stig i programflödet. Trots
kraftfullheten i symbolisk exekvering, finns det ett antal problem med
tekniken. Det är en metod som oftast leder till en långsam exekvering och
begränsas även av stigexplosionsproblemet (jfr eng. \emph{path explosion}), som
orsakas av ett stort antal villkorstest på symbolisk data, i bl.a. loopar,
rekursion och undantag (jfr eng. \emph{exceptions}). Det finns ett antal
metoder för att kringgå stigexplosionsproblemet men lägger stor börda på
analytikern som ofta har ett väldigt begränsad vy in i vad som händer under
exekveringen, oftast genom en textuell gränssnitt. Dessa problem kan utnyttjas
av skadeprogram för att vilseleda binäranalysmetoder som förlitar sig på
symbolisk exekvering.

I den här rapporten föreslår vi AMBA för att, genom bättre kommunikation till
användaren, skapa möjligheter för användaren att känneteckna stigexplosion och
tillåta styrning bort från dessa stigar som orsakar problem. AMBA kommer även
att undersöka alla stigar i programflödet vilket är känd som symbolisk fuzzing.

SymNav~\cite{symnav}, som beskrvis i mer detalj i avsnitt
\ref{chap:existerande_verktyg}, har tidigare undersökt samma problem och
föreslagit liknande lösningar men har
begräsningar i form av prestanda.

% En metod för binäranalys är \emph{fuzzing} som går ut på att mata olika indata
% till ett program och betrakta fel som uppstår. Målet med \emph{fuzzing} är att
% uppnå en hög täckning (jfr eng. \emph{coverage}) av programmet som beror
% på indatan. Alltså att ta alla möjliga vägar i programflödet som är möjliga att
% nå genom att variera indatan. Däremot är det ett svårt problem att generera
% indata som uppnår en hög täckning som även är effektivtast, speciellt när
% indatan kan ha ett högt antal olika värden. 

% Vanliga fel i program som utnyttjas av angripare och skadeprogram är
% minnesårbarheter. Det som gör minnessårbarheter allvarligare till skillnad från
% andra fel som logikfel är att minnessårbarheter kan utnyttjas för att påverka
% programflödet (jfr eng. \emph{control flow}) i ett program och alltså dess
% beteende. Minnesårbarheter tillåter minnesaccess utanför en viss minnesregion.
% Det kan vara alvarligt om en angripare kan läsa delar av minnet som inte ska
% vara läsbart men det mest allvarliga är skrivaccess utanför minnesgränser. En
% angripare kan använda det för att t.ex. exekvera godtyckliga kommandon på
% datorn som kör programmet~\cite{computer_security_cs161}.


% * Svaga argument för någon som vet binäranalys: ransomware ofta
% människoproblem. Kommer inte till kärnan tills mycket senare.
% * Give example where ransomware uses såbarheter
% * legacy code main reason, not used to rust for example, too small memory to
% run high level programs?
% * binary analysis hard and time consuming
% * Use this form in the introduction: Situation - Problem - Solution -
% Evaluation
% * use case: governments need to evaluate safety of products custom made for
% them
%
% * evaluation: result and process discussion - limitation - future work
% * conclution: results and contribution discussion. conclude results discuss why good for the society.
